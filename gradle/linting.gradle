subprojects {
    apply plugin: 'com.diffplug.spotless'

    spotless {
        java {
            target 'src/*/java/**/*.java'
            targetExclude '**/generated/*'
            targetExclude '**/.idea/**'
            googleJavaFormat('1.15.0')
        }

        kotlin {
            ktlint('0.47.1')
                    .setUseExperimental(true)
                    // needs to be aligned with .editorconfig
                    // https://github.com/diffplug/spotless/tree/main/plugin-gradle#ktlint
                    // reenable filename rule after https://github.com/pinterest/ktlint/issues/1521
                    .editorConfigOverride(['indent_size': '2', 'disabled_rules': 'filename'])
        }
    }

    classes.dependsOn 'spotlessApply'
}